# JWT tokens
---
## JWK tampering
**`JSON Web Key`**  is a set of keys containing the public keys used to verify any JSON Web Token (JWT) issued by the authorization server and signed using the RS256 signing algorithm.
## Steps to exploit
1. Find a **`jwks.json`** that the webapp is using for authentication.
```json
// For example
{
    "keys": [
        {
            "kty": "RSA",
            "use": "sig",
            "kid": "hackthebox",
            "alg": "RS256",
            "n": "AMVcGPF62MA_lnClN4Z6WNCXZHbPYr-dhkiuE2kBaEPYYclRFDa24a-AqVY5RR2NisEP25wdHqHmGhm3Tde2xFKFzizVTxxTOy0OtoH09SGuyl_uFZI0vQMLXJtHZuy_YRWhxTSzp3bTeFZBHC3bju-UxiJZNPQq3PMMC8oTKQs5o-bjnYGi3tmTgzJrTbFkQJKltWC8XIhc5MAWUGcoI4q9DUnPj_qzsDjMBGoW1N5QtnU91jurva9SJcN0jb7aYo2vlP1JTurNBtwBMBU99CyXZ5iRJLExxgUNsDBF_DswJoOxs7CAVC5FjIqhb1tRTy3afMWsmGqw8HiUA2WFYcs",
            "e": "AQAB"
        }
    ]
}
```
2. Take the **`kid`** (Key id) and open [https://mkjwk.org/](https://mkjwk.org/) to forge our spoofed JWK.

![[spoofingJWK.png]]
3. Now as shown in the picture above, copy the highlighted key pair  and go to [JWK2PEM Convertor](https://8gwifi.org/jwkconvertfunctions.jsp)

![[JWK2PEM.png]]
4. Now take the key pair  and the new **`jwks.json`** from [https://mkjwk.org/](https://mkjwk.org/) then forge your new **`jwt`**

![[forgedJWKS.png]]

> **`Important!`** Make sure that the format of the original key and the forged one is same.