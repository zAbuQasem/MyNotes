# Pentesting IIS Servers.
## Naviagation
- **[Shortname Scanner](#Shortname%20Scanner)**
- **[Finding API Documentation](#Finding%20API%20Documentation)**
- **[Vhost hopping](#Vhost%20hopping)**
- **[Local File Disclosure](#Local%20File%20Disclosure)**
- **[DnSpy to reverse dll's](#DnSpy%20to%20reverse%20dll's)**
- **[XXE Vectors](#XXE%20Vectors)**
---
## Microsoft ASP.NET Fingerprinting
**Cookies:**
- ASP.NET_SessionId
- ASPSESSION

**Headers Regex:**
- X-AspNet-Version: (.+)\\\\;Version:\\\1,
- X-Powered-By: \^ASP\\\.NET

**HTML Regex:**
- <input[\^>]+name=\\"_VIEWSTATE

**URL Regex:**
- \\\.aspx?(?:$|\\\\?)

## Shortname Scanner
![IIS1](../../assets/WebPentesting/IIS%20Servers/IIS1.png)
![IIS2](../../assets/WebPentesting/IIS%20Servers/IIS2.png)
![IIS3](../../assets/WebPentesting/IIS%20Servers/IIS3.png)]
![IIS4](../../assets/WebPentesting/IIS%20Servers/IIS4.png)
![IIS5](../../assets/WebPentesting/IIS%20Servers/IIS5.png)
![IIS6](../../assets/WebPentesting/IIS%20Servers/IIS6.png)
> Research link: http://soroush.secproject.com/downloadable/microsoft_iis_tilde_character_vulnerability_feature.pdf

> Tool link: https://github.com/irsdl/IIS-ShortName-Scanner

## Finding API Documentation
![IIS7](../../assets/WebPentesting/IIS%20Servers/IIS7.png)
![IIS8](../../assets/WebPentesting/IIS%20Servers/IIS8.png)
![IIS9](../../assets/WebPentesting/IIS%20Servers/IIS9.png)
>  Blog post on using BigQuery to find the rest of the shortname: [https://bit.ly/35P5maY](https://www.youtube.com/redirect?event=video_description&redir_token=QUFFLUhqbkctSXVPWFZ4NFpJUzFEeXB1YWZyMW56X0o4Z3xBQ3Jtc0tsak9ULUFQY25UWDB2cnZvbmh1Q3l5alVIWm5NY3hsMWN2LVA3WUJUVVVaV1BFTkp4allPLVREQk92dHdEOWxiU0RiSkVuRTdQQlNqa2JLWkpETkRkSE1DRkxDSG1TYXRoVVc1a0xkWVZLUFUtTVltYw&q=https%3A%2F%2Fbit.ly%2F35P5maY)



## Vhost hopping
**Can get you access to internal panels**
![vhost1](../../assets/WebPentesting/IIS%20Servers/vhost1.png)

## Local File Disclosure
![lfd](../../assets/WebPentesting/IIS%20Servers/lfd.png)

### RCE via File Disclosure
![lfd to rce](../../assets/WebPentesting/IIS%20Servers/lfd%20to%20rce.png)

## DnSpy to reverse dll's
![dnspy](../../assets/WebPentesting/IIS%20Servers/dnspy.png)

## XXE Vectors
![xxe](../../assets/WebPentesting/IIS%20Servers/xxe.png)